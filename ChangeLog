2009-04-02	Mike Massonnet
Make the plugin run as a standalone application

	- panel-plugin/main.c:
		Rename panel-plugin.c to main.c and use the Full register
		function from libxfce4panel to check if the plugin is run from
		the command line and build a status icon instead of the panel
		plugin with a button.
	- panel-plugin/Makefile.am:
		Install the plugin to bindir.
	- Makefile.am, xfce4-clipman-plugin.desktop.in:
		Install a desktop entry file for the menu.

2009-04-02	Mike Massonnet
Set Clipman the owner of a text content only on specific target

	- panel-plugin/collector.c(cb_clipboard_owner_change):
		Check target of text content and make Clipman the owner of the
		text only if the targets text/plain or text/html is available.
	- panel-plugin/collector.c(cb_check_primary_clipboard):
		Useless call to clipman_history_add_text() as the text is going
		into the default clipboard.

2009-04-02	Mike Massonnet
New test program to report targets

2009-04-02	Mike Massonnet
String update (Regex > Pattern)

2009-04-02	Mike Massonnet
Fix Makefile

	- panel-plugin/Makefile.am:
		I forgot to finish the changes on this file...

2009-04-02	Mike Massonnet
Install a popup command

	- configure.ac.in, panel-plugin/Makefile.am:
		Install the new binary xfce4-popup-clipman.
	- panel-plugin/panel-plugin.c, panel-plugin/common.h:
		Add an X11 selection on the panel plugin and listen to it.
	- panel-plugin/xfce4-popup-clipman.c:
		New binary that sends a message to the X11 selection installed
		in the panel plugin.

2009-04-01	Mike Massonnet
Set long URLs to 120 characters at least

	- panel-plugin/xfce4-clipman-actions.xml.in:
		Change the minimum size of long URLs from 80 to 120

2009-04-01	Mike Massonnet
Update the strings, yet again

2009-04-01	Mike Massonnet
Update the strings

2009-04-01	Mike Massonnet
April April I restore the actions

	- panel-plugin/collector.c(cb_clipboard_owner_change):
		I broked the actions earlier, fixed now.
	- panel-plugin/xfce4-clipman-actions.xml.in:
		New action for long URLs with a command to send the link to TinyURL

2009-03-31	Mike Massonnet
Set sensitivity of OK button in action dialog

	- panel-plugin/panel-plugin.c(panel_plugin_configure):
		Put the action dialog in the same window group as the settings dialog
		to respect its modal state.
	- panel-plugin/panel-plugin.c(panel_plugin_configure):
		Connect action-name, regex, and buttons add-command/delete-command to
		the new callback cb_set_action_dialog_button_ok to set automatically
		the sensitivity of the OK button in the action dialog.
	- panel-plugin/panel-plugin.c(cb_actions_row_activated):
		Set the entry texts after the commands in the treeview so it
		updates the OK button sensitivity via the entry text changes.
	- panel-plugin/panel-plugin.c(cb_add_command):
		Fix the condition to add a new command and do the same check in
		cb_refresh_command.
	- panel-plugin/panel-plugin.c(cb_set_action_dialog_button_ok):
		Verify that there is a command-name, a valid regex, and at least one
		command to set the OK button sensitive, otherwise not.

2009-03-31	Mike Massonnet
Make Clipman the owner of the clipboard contents

	- panel-plugin/collector.c:
		Rename priv->restoring to priv->internal_change.  Drop function
		_clipman_collector_restore_clipboard in favor of making Clipman
		automatically the owner of the clipboard contents.  This doesn't work
		for the primary clipboard as it would destroy the selection under hand
		thus it will lack this functionnality, but all-in-all this clipboard
		is not as mandatory as the default clipboard.

2009-03-31	Mike Massonnet
Save/Load the history in the correct order

	- panel-plugin/panel-plugin.c(panel_plugin_save):
		Obviously I was sure I did that already, but then no trace in
		the logs, so once again, the history was displayed in the
		reverse order each time the plugin restarted, so the list is
		reversed before being saved.  Also free the memory allocated
		to texts as it has to even if there is no texts to be saved.

2009-03-30	Mike Massonnet
Redesign the actions settings dialog

	- panel-plugin/settings-dialog.glade:
		Unify the commands and the actions dialog.  Add a refresh
		button for the command (makes the commands editable).
	- panel-plugin/panel-plugin.c:
		Implement the new callbacks.  Set the settings dialog
		back to transient and put it inside a window group (cause
		gtk_dialog_run makes the dialog modal, cf. bug #4977).
	- panel-plugin/xfce4-clipman-actions.xml.in:
		Change the regex' a little bit.

2009-02-11	Mike Massonnet
Add i18n support for the default XML actions file.

	- panel-plugin/actions.c, panel-plugin/xfce4-clipman-actions.xml.in,
	panel-plugin/Makefile.am:
		Make it possible to have the action and command names
		translated inside the settings dialog just like it is done
		with the Thunar User Custom Actions.
	- panel-plugin/xfce4-clipman-actions.xml:
		This file is now auto-generated, delete it.
	- po/POTFILES.in:
		Add the new .xml.in file to the list of files to translate.

2009-01-30	Mike Massonnet
Drop the idea of an icon for an action.

	- panel-plugin/panel-plugin.c, panel-plugin/actions.c,
	panel-plugin/actions.h:
		Remove the code that was intended to show an icon for an
		action.  It is more a waste of time to set it, and not that
		useful inside the menu.

2009-01-30	Mike Massonnet
Add support for GLib < 2.16 for the commands treeview.

	- panel-plugin/panel-plugin.c:
		New function __foreach_command_fill_commands for versions of
		GLib prior to 2.16.

2009-01-30	Mike Massonnet
Fix a crasher.

	- panel-plugin/history.c(clipman_history_clear):
		Set the item_to_restore to NULL when clearing the history.
	- panel-plugin/collector.c(_clipman_collector_restore_clipboard):
		Check if the item to restore is not NULL.

2009-01-30	Mike Massonnet
Remove the origin of the clipboard from the history items.

	- panel-plugin/history.h, panel-plugin/history.c:
		Don't store from where a clipboard originated from (useless).
		Update the public methods and the struct ClipmanHistoryItem.
	- panel-plugin/collector.c, panel-plugin/panel-plugin.c:
		Update the code to use the new function declarations.

2009-01-30	Mike Massonnet
Set the settings dialog "buggy".

	- panel-plugin/panel-plugin.c:
		In a way to fix weird bugs, the settings dialog is no more
		transient for the top level widget of the panel plugin.
	- panel-plugin/settings-dialog.glade:
		Both dialogs "action-dialog" and "command-dialog" skip the
		taskbar and have the type hint "dialog".

2009-01-26	Mike Massonnet
Actions are configurable through the settings dialog.

	- panel-plugin/actions.c:
		Fix a crasher in clipman_actions_load() when reading the XML
		file from the user config directory.  Add debug messages when
		loading and saving the XML file.
	- panel-plugin/actions.c(clipman_actions_get_entries):
		New method to retrieve the list of every acion.
	- panel-plugin/actions.c(clipman_actions_remove_command):
		Renamed the method clipman_actions_remove() to
		clipman_actions_remove_command() and re-implement
		clipman_actions_remove() to remove an entry entirely.
	- panel-plugin/settings-dialog.glade:
		Rename some widgets and add signal handlers.
	- panel-plugin/panel-plugin.c:
		Set up the actions dialog in panel_plugin_configure() and a
		add a load of new callbacks and functions specific to the
		settings dialog to add/edit/delete actions.

2009-01-26	Mike Massonnet
Small tweak in the GRegex.

	- panel-plugin/actions.c(clipman_actions_add):
		Add the compile flag "caseless" and move the match option
		"anchored" to the compile flags.
	- configure.ac.in:
		Add GTK+/GLib requirements to 2.10/2.14.

2009-01-25	Mike Massonnet
Forget to add support for GLib < 2.16 to save the actions.

	- panel-plugin/actions.c:
		I somehow was too hasty to commit, and forgot about support
		for GLib < 2.16 to save the actions to the XML file.

2009-01-25	Mike Massonnet
Fix g_debug().

	- Looks like I left some g_debug() calls in the code.

2009-01-25	Mike Massonnet
Actions are saved/loaded to/from an XML file.

	- panel-plugin/actions.c(clipman_actions_load):
		Load actions from an XML file from the user config directory
		or fallback to a system wide config directory.  Drop the
		hard-coded actions.
	- panel-plugin/actions.c(clipman_actions_save):
		Save the actions in an XML format inside the user config
		directory.
	- panel-plugin/actions.c(clipman_actions_add):
		Create the regex with the flag "anchored" to force the regex'
		with a starting ^ and an ending $.
	- panel-plugin/Makefile.am:
		Declare SYSCONFDIF and add XML actions file.
	- panel-plugin/xfce4-clipman-actions.xml:
	 	Default system wide configuration file of the actions.

2009-01-25	Mike Massonnet
Actions are available but hard-coded at this time.

	- configure.ac.in, tests/*:
		Add a test program for the actions.
	- panel-plugin/actions.c, panel-plugin/actions.h,
	panel-plugin/Makefile.am:
		A new GObject ClipmanActions with methods to add and remove
		commands for a specific regex.  The code to save and load from
		an XML file still needs to be written.
	- panel-plugin/collector.c, panel-plugin/panel-plugin.c:
		Install new property "enable-actions" which will match the
		clipboard texts for actions.  Bind the property to xfconf
		inside panel_plugin_register().
	- panel-plugin/collector.c(cb_clipboard_owner_change):
		Change timeout from 500 to 250 milliseconds to make the
		actions respond faster on a mouse release.
	- panel-plugin/settings-dialog.glade:
		New dialogs for the actions.

2009-01-15	Mike Massonnet
Some minor changes.

	- panel-plugin/panel-plugin.c(panel_plugin_configure),
	panel-plugin/settings-dialog.glade:
		The menu is blocked while the dialog is shown.  Set the dialog
		transient for the panel plugin toplevel window and destroy with
		the parent (this introduces a bug: the panel button remains
		unclickable but dunno why).
	- panel-plugin/collector.c(cb_check_primary_clipboard):
		Change the behavior of the "add-primary-selection" option to
		copy the text to the default clipboard, so that it now behaves
		like "what you select can be pasted".
	- panel-plugin/panel-plugin.c(panel_plugin_load,panel_plugin_save):
		Load/Save the images with the extension ".png".
	- panel-plugin/panel-plugin.c(panel_plugin_load,panel_plugin_save):
		Correct the size allocated to texts.  Fixes a free corruption!

2009-01-14	Mike Massonnet
The settings dialog is in.

	- configure.ac.in, panel-plugin/Makefile.am:
		Add Glade dependency for the settings dialog.
	- panel-plugin/common.h, panel-plugin/history.c,
	panel-plugin/collector.c:
		Declare define names for the default values, also rename the
		property ignore-primary-clipboard from ClipmanCollector to
		add-primary-clipboard to keep the easiness of Xfconf bindings
		inside the settings dialog.
	- panel-plugin/panel-plugin.c:
		Connect configure function from XfcePanelPlugin.
	- panel-plugin/settings-dialog.glade:
		The Glade interface of the settings dialog.

2009-01-13	Mike Massonnet
New property in ClipmanHistory "save-on-quit".

	- panel-plugin/history.c:
		Install new property "save-on-quit".
	- panel-plugin/panel-plugin.c:
		Bind property "save-on-quit" from ClipmanHistory to Xfconf and
		use it in plugin_panel_load() and plugin_panel_save().

2009-01-13	Mike Massonnet
Save the history on disk.

	- panel-plugin/history.c, panel-plugin/history.h:
		New function clipman_history_get_list() and drop the functions
		clipman_history_get_texts() and clipman_history_get_images().
	- panel-plugin/menu.c(_clipman_menu_update_list):
		Use the new function replacement from ClipmanHistory.
	- panel-plugin/panel-plugin.c:
		Implement new functions panel_plugin_load() and
		panel_plugin_save() to respectively load the history (images
		and texts) and save the history.

2009-01-09	Mike Massonnet
Some small fixes.

	- panel-plugin/history.c(clipman_history_add_text):
		Don't escape the text for markups as the preview is displayed
		as a label, and not as a markup.
	- panel-plugin/history.c(clipman_history_finalize):
		Clear the GSLists stored inside ClipmanHistory on finalize.
	- panel-plugin/menu.c(_clipman_menu_update_list):
		Set the clear history menu item sensitive/insensitive given the
		status of the history.  For that store a pointer of the menu
		item inside the private data.
	- panel-plugin/collector.c(cb_clipboard_owner_change):
		Make sure the image is not NULL before adding it to the history

2009-01-09	Mike Massonnet
Major rewrite of the plugin using GObjects and Xfconf.

	- The plugin now uses GObjects with properties binded to Xfconf for easy
	configuration.
	- The plugin is able to store texts and images.
	- The changes over the clipboards are noticed with signals and no more
	a timeout which saves a lot of CPU wakeups.

